#!/usr/bin/env bash

# Revert file permissions to their previous state if they are the only changes.

# Get the list of files where only permissions have changed
changed_files=$(git diff --name-only --diff-filter=MM)

# Iterate over each file and revert permissions
for file in $changed_files; do
    # Check if the only difference is in file mode
    if git diff HEAD^ HEAD -- "$file" | grep -q 'old mode'; then
        printf "Reverting permissions for %s\n" "$file"
        git checkout HEAD^ -- "$file"
    fi
done
